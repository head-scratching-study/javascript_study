# Chapter45 Questions

### 1. 콜백 헬이 무엇인가요?

- 콜백 함수를 통해 비동기 처리 결과에 대한 후속 처리를 수행하는 비동기 함수가 비동기 처리 결과를 가지고 다시 비동기 함수를 호출해야 한다면 콜백 함수 호출이 중첩되어 복잡도가 높아지는 현상을 말합니다.

#### 1.1 콜백 헬을 해결하기 위해 도입된 해결책은 무엇인가요?

- ES6에서 프로미스가 도입되면서 비동기 처리 결과에 대한 후속 처리를 후속 처리 메서드인 then, catch, finally가 수행함으로써 콜백 헬에서 벗어날 수 있게 되었습니다.

<br>

### 2. 프로미스가 무엇인가요?

- 프로미스는 비동기 처리 상태와 비동기 처리 결과를 관리하는 객체를 말합니다. 프로미스는 Promise 생성자 함수를 new 연산자와 함께 호출하여 생성합니다. 프로미스는 후속 처리 메서드로 then, catch, finally를 가지고 있고, 정적 메서드로 resolve, reject, all, allSettled, race를 가지고 있습니다.

#### 2.1 비동기 처리 상태에 따라 프로미스가 어떻게 변화하나요?

- 비동기 처리가 아직 수행되지 않은 경우, 프로미스는 pending 상태입니다.
- 비동기 처리가 수행된 경우, 프로미스는 resolve 함수를 호출해 fulfilled 상태로 변경됩니다.
- 비동기 처리에 실패한 경우, 프로미스는 reject 함수를 호출해 rejected 상태로 변경됩니다.
- 프로미스가 fulfilled 또는 rejected 상태인 경우 settled 상태라고 합니다.
- 프로미스가 한 번 settled 상태가 되면 더는 다른 상태로 변경되지 않습니다.

<br>

### 3. 프로미스 체이닝에 대해 설명해주세요.

- 프로미스의 후속 처리 메서드 then, catch, finally는 언제나 프로미스를 반환하므로 연속적으로 호출할 수 있습니다. 이를 프로미스 체이닝이라 합니다.

<br>

### 4. Promise의 정적 메서드 all, race, allSettled를 비교하여 설명해주세요.

- Promise.all, Promise.race, Promise.allSettled 메서드 모두 프로미스를 요소로 갖는 이터러블을 인수로 전달받고, 여러 개의 비동기 처리를 병렬로 처리할 때 사용합니다.
- Promise.all 메서드는 인수로 전달받은 모든 프로미스가 fulfilled 상태가 되면 resolve한 처리 결과를 차례대로 배열에 저장해 반환합니다. 또한 인수로 전달받은 프로미스 중 하나라도 rejected 상태가 되면 나머지 프로미스가 fulfilled 상태가 되는 것을 기다리지 않고 즉시 종료합니다.
- Promise.race 메서드는 가장 먼저 fulfilled 상태가 된 프로미스의 처리 결과를 resolve하는 새로운 프로미스를 생성해 반환합니다. 또한 인수로 전달받은 프로미스가 하나라도 rejected 상태가 되면 에러를 reject하는 새로운 프로미스를 생성해 반환합니다.
- Promise.allSettled 메서드는 인수로 전달받은 모든 프로미스가 settled 상태가 되면 처리 결과를 배열로 반환합니다. 반환한 배열에는 fulfilled 또는 rejected 상태와 상관없이 인수로 전달받은 모든 프로미스의 처리 결과가 모두 담겨 있습니다.

<br>

### 5. 다음 예제를 살펴보고 어떤 순서로 로그가 출력될지 설명해주세요.

```js
setTimeout(() => console.log(1), 0);

Promise.resolve()
  .then(() => console.log(2))
  .then(() => console.log(3));
```

- 2 -> 3 -> 1 순으로 출력됩니다. 그 이유는 프로미스의 후속 처리 메서드의 콜백 함수는 그 외의 비동기 함수와 이벤트 핸들러와 달리 마이크로태스크 큐에 저장됩니다. 그리고 마이크로태스크 큐가 태스크 큐보다 우선순위가 높기 때문에, 콜 스택이 비면 마이크로태스크 큐에 저장된 프로미스의 후속 처리 메서드의 콜백 함수가 먼저 실행되고, 마이크로태크스 큐가 비면 태스크 큐에 저장된 비동기 함수가 실행됩니다.

<br>

### 6. fetch와 axios를 비교하여 설명해주세요.

- fetch 함수와 axios 함수 모두 HTTP 요청 전송 기능을 하는 클라이언트 Web API이고, HTTP 응답을 나타내는 Response 객체를 래핑한 Promise 객체를 반환합니다.
- fetch 함수가 반환하는 프로미스는 404 Not Found나 500 Internal Server Error와 같은 HTTP 에러가 발생해도 에러를 reject하지 않고 불리언 타입의 ok 상태를 false로 설정한 Response 객체를 resolve합니다. 오프라인 장애나 CORS 에러 등 요청이 완료되지 않은 경우에만 에러를 reject합니다. 따라서 fetch 함수를 사용할 때는 fetch 함수가 반환한 프로미스가 resolve한한 불리언 타입의 ok 상태를 확인하여 명시적으로 에러 처리를 해주어야 합니다.
- axios는 모든 HTTP 에러를 reject하는 프로미스를 반환합니다. 따라서 모든 에러를 catch에서 처리할 수 있어 편리합니다. 또한 axios는 인터셉터, 요청 설정 등 fetch보다 다양한 기능을 제공합니다.
