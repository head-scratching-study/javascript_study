## 22.1 this 키워드

메서드는 자신이 속한 객체의 상태인 프로퍼티를 참조하고 변경할 수 있어야한다.
메서드는 자신이 속한 객체를 참조하는 방법은 객체 생성방식에 따라 다를 수 있다.

### 객체 내부에서 재귀적으로 참조

객체 리터럴 방식으로 생성한 객체는 메서드 내부에서 객체를 재귀적으로 참조할 수 있다. 메서드내에 참조하려는 객체의 식별자가 평가되는 시점은 메서드가 호출되어 함수가 실행되는 시점으로 이미 해당 식별자로 객체가 생성되어있는 상태이므로 메서드 내부에서 식별자를 참조할 수 있다.그러나 이러한 방법은 일반적이지 않다.

생성자 함수를 이용한 객체 생성시 생성자 함수 호출을 먼저 호출 후 인스턴스가 생성되므로 생성자 함수 호출 시 인스턴스 식별자를 알 수 없다.

### this를 사용하여 참조

자신이 생성할 인스턴스를 가리키는 특수한 식별자 this를 사용하여 자신이 속한 객체를 참조할 수 있다.
**this는 자신이 속한 객체 또는 자신이 생성할 인스턴스를 가리키는 자기 참조 변수이다.** this를 통해 자신이 속한 객체, 객체내부의 프로퍼티등을 참조할 수 있다.
this는 자바스크립트 엔진에 의해 암묵적으로 생성되며 this의 값은 함수 호출방식에 따라 동적으로 결저오딘다.

## 22.2 함수 호출 방식과 this 바인딩

자바스크립트의 this는 함수가 호출되는 방식에 따라 this에 바인딩될 값을 결정한다.

### 22.2.1 일반 함수 호출

기본적으로 일반 함수내부에서 this에는 전역객체가 바인딩되지만 strict mode가 적용된 일반 함수 내부에서는 this는 undefined 를 가리킨다. (strict mode ㄷ역시 this 바인딩에 영향을 준다.)
메서드내에서 정의한 중첩함수도 일반함수로 중첩되면 그 내부 this에는 전역객체 ( strict mode가 적용된 경우 undefined)가 바인딩된다.
메서드내, 혹은 외부에서 정의한 일반함수로 호출되는 콜백함수 내부 this에도 전역객체 ( strict mode가 적용된 경우 undefined)가 바인딩된다.

결국 일반 함수로 호출된 모든 함수(중첩함수, 콜백함수) 내부 this에는 전역 객체가 비인딩된다.

만약 메서드내 중첩된 일반함수에서 자신이 속한 객체를 참조하기 위해서는

1.  변수를 사용하여 참조하거나
2.  apply, call, bind 메서드를 사용하거나
3.  화살표 함수를 사용할 수 있다.

> 렉시컬 스코프와 this 바인딩 결정 시기는 다르다. 렉시컬 스코프는 함수 정의가 평가되어 함수객체가 등록되는 시점, this는 함수 호출 시점에 결정된다.

### 22.2.2 메서드 호출

메서드 내부에서 this는 메서드를 호출한 객체를 가리킨다. 메서드를 호출할 때, 메서드 앞 마침표(.) 연산자 앞에 기술한 객체가 바인딩 된다.
메서드에 내부에서의 this는 해당 메서드, 즉 프로퍼티에 할당된 함수가 어디에 할당하느냐에 따라 참조하는 식별자(대상)이 달라질 수 있다. 즉 메서드 내부의 this는 메서드를 소유한 객체와는 관계가 없고 메서드를 호출한 객체에 바인딩된다.

### 22.2.3 생성자 함수 호출

생성자 함수 내부의 this에는 생성자 함수가 생성할 인스턴스가 비인딩된다.

### 22.2.4 apply/call/bind에 의한 간접 호출

apply, call, bind 메서드는 Function.prototype의 메서드로 기본적으로 모든 함수가 상속받아 사용할 수 있다.

apply, call메서는 함수내부에서 this에 바인딩할 객체와 인수 리스트를 인수로 전달받아 함수를 호출한다.
apply,call 메서드의 본질적인 기능은 함수를 호출하는 것으로 함수 내부 this에 전달받은 객체를 바인딩하면서 인수를 이용하여 함수를 호출한다.

apply,call는 인수를 전달하는 방법만 다를 뿐 동일하게 동작한다.
apply메서드는 인수를 배열로, call 메서드는 함수를 쉼표로 구분하여 개별로 전달한다.

bind 메서드는 함수를 호출하지 않고 첫번째 인수로 전달된 값으로 this가 바인딩된 함수를 생성하여 반환한다.
bind 메서드는 메서드의 this와 중첩함수, 콜백함수 내부의 this를 동일하게 설정할 때 유용하다.
